<?php
/**
 * @file
 * Code for the GIE Microsite feature.
 */

include_once 'gie_microsite.features.inc';


/**
 * Implements hook_menu_alter().
 */
function gie_microsite_menu_alter(&$items) {
  $items['taxonomy/term/%taxonomy_term']['access callback'] = 'gie_microsite_access_callback';
  $items['taxonomy/term/%taxonomy_term']['access arguments'] = array(
    2,
    'access content'
  );
  $items['admin/structure/taxonomy/%taxonomy_vocabulary_machine_name/add']['access callback'] = 'gie_microsite_access_callback';
  $items['admin/structure/taxonomy/%taxonomy_vocabulary_machine_name/add']['access arguments'] = array(
    2,
    'access content'
  );
  $items['taxonomy/term/%taxonomy_term/edit']['access callback'] = 'gie_microsite_access_callback';
  $items['taxonomy/term/%taxonomy_term/edit']['access arguments'] = array(
    2,
    'access content'
  );

}

function gie_microsite_access_callback($term, $string, $account = NULL, $reset = FALSE) {
  $domain = $GLOBALS['_domain'];

  if (!empty($term) && $term->vocabulary_machine_name == 'youthpower_issues') {
    if (!empty($domain) && $domain['domain_id'] == 7) {
      return TRUE;
    }
    return FALSE;
  }
  return TRUE;

}




